<ul class="categories">
  <% collection.arrange.each do |category, sub_item| %>
    <li>
      <%= link_to category.name, category_path(category) %>
      <% if category.has_children? %>
        <%= render partial: "category", locals: { collection: category.children } %>
      <% end %>
      <% if category.posts.present? %>
        <ul class="categories">
          <% category.posts.each do |post| %>
            <li>
              <%= link_to post.name, post_path(post) %>
            </li>
          <% end %>
        </ul>
      <% end %>
    </li>
  <% end %>
</ul>